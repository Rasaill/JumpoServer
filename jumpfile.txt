$siteUrl = "https://pmicloud.sharepoint.com/sites/ManilaInfraCore"
$listName = "EdgeAPITest"

# Step 1: Get Authentication Token (ContextInfo)
$contextResponse = Invoke-RestMethod -Uri "$siteUrl/_api/contextinfo" -Method POST -Headers @{
    "Accept" = "application/json;odata=verbose"
}
$token = $contextResponse.d.GetContextWebInformation.FormDigestValue

# Step 2: Create the new item
$body = @{
    '__metadata' = @{ 'type' = 'SP.Data.EdgeAPITestListItem' }
    'Title' = 'REST Write Test from PowerShell'
} | ConvertTo-Json

$response = Invoke-RestMethod `
    -Uri "$siteUrl/_api/web/lists/getbytitle('$listName')/items" `
    -Method POST `
    -Headers @{
        "Accept" = "application/json;odata=verbose"
        "Content-Type" = "application/json;odata=verbose"
        "X-RequestDigest" = $token
    } `
    -Body $body

$response
